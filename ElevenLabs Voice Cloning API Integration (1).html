<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElevenLabs Voice Cloning App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            font-size: 2.2rem;
            font-weight: 600;
        }

        .section {
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .section h3 {
            margin-bottom: 15px;
            color: #4f46e5;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #374151;
            font-weight: 500;
        }

        input[type="text"], textarea, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
            transform: translateY(-1px);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .button:active {
            transform: translateY(-1px);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
            color: #667eea;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #10b981;
            background: rgba(16, 185, 129, 0.1);
            display: none;
        }

        .error {
            border-left-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }

        .success {
            color: #059669;
        }

        audio {
            width: 100%;
            margin-top: 15px;
        }

        .voice-list {
            max-height: 200px;
            overflow-y: auto;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            background: white;
        }

        .voice-item {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .voice-item:hover {
            background-color: #f9fafb;
        }

        .voice-item.selected {
            background-color: #ede9fe;
            border-left: 4px solid #8b5cf6;
        }

        .api-key-input {
            position: relative;
        }

        .api-key-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üé§ ElevenLabs Voice Cloning</h1>
        
        <div class="section">
            <h3>üîë API Configuration</h3>
            <div class="form-group">
                <label for="apiKey">ElevenLabs API Key:</label>
                <div class="api-key-input">
                    <input type="password" id="apiKey" placeholder="Enter your ElevenLabs API key">
                    <button class="api-key-toggle" onclick="toggleApiKeyVisibility()">üëÅÔ∏è</button>
                </div>
            </div>
            <button class="button" onclick="loadVoices()">Load Available Voices</button>
        </div>

        <div class="section">
            <h3>üé≠ Voice Selection</h3>
            <div class="form-group">
                <label>Select Voice:</label>
                <div id="voiceList" class="voice-list" style="display: none;">
                    <!-- Voices will be populated here -->
                </div>
                <div id="voiceError" class="result error" style="display: none;"></div>
            </div>
        </div>

        <div class="section">
            <h3>üí¨ Text to Speech</h3>
            <div class="form-group">
                <label for="textInput">Enter text to convert:</label>
                <textarea id="textInput" placeholder="Type your message here...">Hello! This is a demonstration of ElevenLabs voice cloning technology. The quality is quite impressive!</textarea>
            </div>
            
            <div class="form-group">
                <label for="stabilitySlider">Voice Stability: <span id="stabilityValue">0.5</span></label>
                <input type="range" id="stabilitySlider" min="0" max="1" step="0.1" value="0.5" 
                       oninput="document.getElementById('stabilityValue').textContent = this.value"
                       style="width: 100%; margin: 10px 0;">
            </div>

            <div class="form-group">
                <label for="claritySlider">Voice Clarity: <span id="clarityValue">0.75</span></label>
                <input type="range" id="claritySlider" min="0" max="1" step="0.1" value="0.75"
                       oninput="document.getElementById('clarityValue').textContent = this.value"
                       style="width: 100%; margin: 10px 0;">
            </div>

            <button class="button" onclick="generateSpeech()">üîä Generate Speech</button>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                Generating speech...
            </div>
            
            <div id="speechResult" class="result"></div>
        </div>
    </div>

    <script>
        let selectedVoiceId = null;
        
        function toggleApiKeyVisibility() {
            const input = document.getElementById('apiKey');
            const toggle = document.querySelector('.api-key-toggle');
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.textContent = 'üôà';
            } else {
                input.type = 'password';
                toggle.textContent = 'üëÅÔ∏è';
            }
        }

        async function loadVoices() {
            const apiKey = document.getElementById('apiKey').value;
            if (!apiKey) {
                showError('voiceError', 'Please enter your ElevenLabs API key first.');
                return;
            }

            try {
                const response = await fetch('https://api.elevenlabs.io/v1/voices', {
                    headers: {
                        'xi-api-key': apiKey
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                displayVoices(data.voices);
                
            } catch (error) {
                console.error('Error loading voices:', error);
                showError('voiceError', 'Failed to load voices. Please check your API key and try again.');
            }
        }

        function displayVoices(voices) {
            const voiceList = document.getElementById('voiceList');
            const voiceError = document.getElementById('voiceError');
            
            voiceError.style.display = 'none';
            voiceList.style.display = 'block';
            voiceList.innerHTML = '';

            voices.forEach(voice => {
                const voiceItem = document.createElement('div');
                voiceItem.className = 'voice-item';
                voiceItem.innerHTML = `
                    <strong>${voice.name}</strong>
                    <div style="font-size: 14px; color: #6b7280; margin-top: 4px;">
                        ${voice.labels?.accent || 'Unknown accent'} ‚Ä¢ 
                        ${voice.labels?.age || 'Unknown age'} ‚Ä¢ 
                        ${voice.labels?.gender || 'Unknown gender'}
                    </div>
                `;
                
                voiceItem.onclick = () => {
                    document.querySelectorAll('.voice-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    voiceItem.classList.add('selected');
                    selectedVoiceId = voice.voice_id;
                };
                
                voiceList.appendChild(voiceItem);
            });
        }

        async function generateSpeech() {
            const apiKey = document.getElementById('apiKey').value;
            const text = document.getElementById('textInput').value;
            const stability = parseFloat(document.getElementById('stabilitySlider').value);
            const clarity = parseFloat(document.getElementById('claritySlider').value);
            
            if (!apiKey) {
                showError('speechResult', 'Please enter your API key.');
                return;
            }
            
            if (!selectedVoiceId) {
                showError('speechResult', 'Please select a voice first.');
                return;
            }
            
            if (!text.trim()) {
                showError('speechResult', 'Please enter some text to convert.');
                return;
            }

            const loading = document.getElementById('loading');
            const result = document.getElementById('speechResult');
            const button = event.target;
            
            loading.style.display = 'block';
            result.style.display = 'none';
            button.disabled = true;

            try {
                const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${selectedVoiceId}`, {
                    method: 'POST',
                    headers: {
                        'Accept': 'audio/mpeg',
                        'Content-Type': 'application/json',
                        'xi-api-key': apiKey
                    },
                    body: JSON.stringify({
                        text: text,
                        model_id: 'eleven_monolingual_v1',
                        voice_settings: {
                            stability: stability,
                            similarity_boost: clarity,
                            style: 0,
                            use_speaker_boost: true
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail?.message || `HTTP error! status: ${response.status}`);
                }

                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                
                result.innerHTML = `
                    <div class="success">
                        ‚úÖ Speech generated successfully!
                        <audio controls>
                            <source src="${audioUrl}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                        <br><br>
                        <a href="${audioUrl}" download="generated-speech.mp3" class="button" style="display: inline-block; text-decoration: none; margin-top: 10px;">
                            üì• Download Audio
                        </a>
                    </div>
                `;
                result.style.display = 'block';
                
            } catch (error) {
                console.error('Error generating speech:', error);
                showError('speechResult', `Failed to generate speech: ${error.message}`);
            } finally {
                loading.style.display = 'none';
                button.disabled = false;
            }
        }

        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.className = 'result error';
            element.innerHTML = `‚ùå ${message}`;
            element.style.display = 'block';
        }

        // Add some sample text suggestions
        const sampleTexts = [
            "Hello! This is a demonstration of ElevenLabs voice cloning technology.",
            "The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet.",
            "Welcome to our application! We're excited to show you what's possible with AI voice synthesis.",
            "Good morning! I hope you're having a wonderful day. The weather is beautiful today."
        ];

        // Add sample text rotation
        let currentSample = 0;
        setInterval(() => {
            const textInput = document.getElementById('textInput');
            if (textInput.value === sampleTexts[currentSample] || textInput.value === '') {
                currentSample = (currentSample + 1) % sampleTexts.length;
                textInput.placeholder = sampleTexts[currentSample];
            }
        }, 5000);
    </script>
</body>
</html>